<Window x:Class="FloridaLotteryApp.AnalysisLineMatchesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Coincidencias de líneas"
        Height="700" Width="980"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="16">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <TextBlock Text="{Binding MatchSummary}"
                           FontSize="16"
                           FontWeight="Bold"
                           Margin="0,0,0,16"/>
                <ItemsControl ItemsSource="{Binding Cards}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border CornerRadius="16"
                                    BorderBrush="Black"
                                    BorderThickness="2"
                                    Padding="14"
                                    Margin="0,0,0,14"
                                    Background="White"
                                    Loaded="CardBorder_Loaded">

                                <Grid>
                                    <Canvas x:Name="Pick3LinksCanvas"
                                            IsHitTestVisible="False"
                                            Panel.ZIndex="2"/>
                                    <StackPanel>

                                        <!-- ======= FILA GUÍA (SIEMPRE IGUAL) ======= -->
                                        <Border Background="White" CornerRadius="10" Padding="10">
                                            <StackPanel>

                                                <!-- fecha/tirada -->
                                                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                    <TextBlock Text="Fecha:" FontSize="16" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding GuideDateText}" FontSize="16" Margin="6,0,18,0"/>
                                                    <TextBlock Text="Tirada:" FontSize="16" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding GuideDrawIcon}" FontSize="18" Margin="6,0,0,0"/>
                                                </StackPanel>

                                                <!-- línea de dígitos -->
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Pick3 (3) -->
                                                    <ItemsControl x:Name="GuidePick3Items"
                                                                  Grid.Column="0"
                                                                  ItemsSource="{Binding GuidePick3Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="3"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Pick4 (4) -->
                                                    <ItemsControl Grid.Column="2" ItemsSource="{Binding GuidePick4Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="4"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Próxima tirada (3) -->
                                                    <ItemsControl x:Name="GuideNextPick3Items"
                                                                  Grid.Column="4"
                                                                  ItemsSource="{Binding GuideNextPick3Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="3"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Codificación (6) -->
                                                    <ItemsControl Grid.Column="6" ItemsSource="{Binding GuideCodingDigits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="6"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </Grid>
                                            </StackPanel>
                                        </Border>

                                        <!-- ======= FILA RESULTADO ======= -->
                                        <Border Background="White" CornerRadius="10" Padding="10" Margin="0,12,0,0">
                                            <StackPanel>

                                                <!-- línea de dígitos -->
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="26"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Pick3 (3) -->
                                                    <ItemsControl x:Name="ResPick3Items"
                                                                  Grid.Column="0"
                                                                  ItemsSource="{Binding ResPick3Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="3"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Pick4 (4) -->
                                                    <ItemsControl Grid.Column="2" ItemsSource="{Binding ResPick4Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="4"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Próxima tirada (3) -->
                                                    <ItemsControl x:Name="ResNextPick3Items"
                                                                  Grid.Column="4"
                                                                  ItemsSource="{Binding ResNextPick3Digits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="3"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>

                                                    <!-- Codificación (6) -->
                                                    <ItemsControl Grid.Column="6" ItemsSource="{Binding ResCodingDigits}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Rows="1" Columns="6"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Width="34" Height="34" CornerRadius="17"
                                                                        BorderThickness="2" BorderBrush="White"
                                                                        Background="{Binding Bg}"
                                                                        Margin="4,0">
                                                                    <TextBlock Text="{Binding Value}"
                                                                               FontSize="16" FontWeight="Bold"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </Grid>

                                                <!-- fecha/tirada -->
                                                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                    <TextBlock Text="Fecha:" FontSize="16" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding ResDateText}" FontSize="16" Margin="6,0,18,0"/>
                                                    <TextBlock Text="Tirada:" FontSize="16" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding ResDrawIcon}" FontSize="18" Margin="6,0,0,0"/>
                                                </StackPanel>

                                            </StackPanel>
                                        </Border>

                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window> 